# Improved Quantitative Susceptibility Mapping with Weighted Total Least Squares

**Matlab Codes:**

#Matlab Implementation of Weighted Total Least Squares Algorithm (proposed):

**Phantom simulations: Generate_Fig1.m**

                                        Generate_Fig2.m

                                        Generate_Fig3.m (requires various_snr.m)

                                        Generate_Fig4.m

                                        Generate_Fig5.m

                                        Generate_Fig6.m

requires ---- data can be downloaded from: [http://weill.cornell.edu/mri/pages/qsm.html](http://pre.weill.cornell.edu/mri/pages/qsm.html)

                    qsm_lttls.m

                    ttls_my.m

                    sparse_tv_qsm.m

                    addNoise.m

                    compute_rmse.m

                    compute_hfen.m

                    compute_ssim.m

                    viewOrthoSlices2D_phantom_view.m

**in vivo simulations**: Generate_Fig7.m

requires ----  data can be downloaded from: [http://www.neuroimaging.at/qsm2016/pages/qsm-challenge.php](http://www.neuroimaging.at/qsm2016/pages/qsm-challenge.php)

                    viewOrthoSlices2D_myrealnew.m

The data obtained after adding noise to the numerical phantom cases to test TLS methods were shared in the following link:

[https://drive.google.com/open?id=0B2HqXYSU1ttaOXhfcENYQ2ROU2c](https://drive.google.com/open?id=0B2HqXYSU1ttaOXhfcENYQ2ROU2c)

#Matlab Implementation of LSQR, L2, and L1 Algorithm:            

Available in:

J.Chung, L.Ruthotto, "Computational Methods for Image Reconstruction", (http://dx.doi.org/10.1002/nbm.3545), NMR Biomedicine Special Issue: QSM, 2016.

This Matlab code is used as part of the work presented in:

Sreedevi Gutta, Venkata Suryanarayana Kadimesetty, and Phaneendra K. Yalavarthy, â€œImproved Quantitative Susceptibility Mapping with Weighted Total Least Squares," Magnetic Resonance in Medicine (Submitted).

Created on: Dec 22, 2016

Modified on: May 29, 2017
